"use strict";document.addEventListener("DOMContentLoaded",function(){function a(a){for(var g=2;g<=a;g++){var b=document.getElementById("package-form-template").content.cloneNode(!0),c=b.getElementById("webservicepackage-reffnr"),d=b.querySelector(".field-webservicepackage-reffnr"),e=b.getElementById("webservicepackage-weight"),f=b.querySelector(".field-webservicepackage-weight");c.value=document.querySelector(".form-wrapper #webservicepackage-reffnr-1").value,c.setAttribute("name","shipment[WebServicePackage]["+g+"][reffnr]"),c.id="webservicepackage-reffnr-"+g,d.classList.remove("field-webservicepackage-reffnr"),d.classList.add("field-webservicepackage-reffnr-"+g),e.setAttribute("name","shipment[WebServicePackage]["+g+"][weight]"),e.id="webservicepackage-weight-"+g,f.classList.remove("field-webservicepackage-weight"),f.classList.add("field-webservicepackage-weight-"+g),document.getElementById("packageWrapper").append(b),$("#create-parcel-shipment").yiiActiveForm("add",{id:"webservicepackage-reffnr-"+g,name:"shipment[WebServicePackage]["+g+"][reffnr]",container:".field-webservicepackage-reffnr-"+g,input:"#webservicepackage-reffnr-"+g,error:".help-block",validate:function validate(a,b,c){yii.validation.required(b,c,{message:"Pole Referen\u010Dn\xE9 \u010D\xEDslo bal\xEDka nesmie by\u0165 pr\xE1zdne."})}}),$("#create-parcel-shipment").yiiActiveForm("add",{id:"webservicepackage-weight-"+g,name:"shipment[WebServicePackage]["+g+"][weight]",container:".field-webservicepackage-weight-"+g,input:"#webservicepackage-weight-"+g,error:".help-block",validate:function validate(a,b,c){yii.validation.required(b,c,{message:"Pole V\xE1ha bal\xEDka (KG) nesmie by\u0165 pr\xE1zdne."})}})}}document.querySelector("body #modalGlobal #send-to-parcel").addEventListener("mouseover",function(a){var b=0;document.querySelectorAll("body #modalGlobal .package-weight").forEach(function(a){b+=parseFloat(a.value)}),b==parseFloat("$weight")?(a.target.removeAttribute("disabled"),document.getElementById("send-to-parcel-msg").innerText=""):(a.target.setAttribute("disabled","disabled"),document.getElementById("send-to-parcel-msg").innerText="V\xE1ha bal\xEDkov "+b+" sa nezhoduje z v\xE1hou objedn\xE1vky $weight")}),document.getElementById("parcel-map-dropdown").addEventListener("change",function(a){var b=a.target.dataset.url+a.target.value+"&address="+document.getElementById("pickup-address-dropdown").value+"&modelID="+document.getElementById("modelID").value;fetch(b).then(function(a){return a.json()}).then(function(a){if(!0===a.success){document.querySelectorAll(".map-inputs").forEach(function(a){a.value=""});for(var b=function(){var b=d[c];"webservicepackage-reffnr"===b?document.querySelectorAll(".package-reffnr").forEach(function(c){c.value=a.values[b]}):"webservicepackage-weight"===b?document.querySelectorAll(".package-weight").forEach(function(c){c.value=a.values[b]}):document.getElementById(b)&&(document.getElementById(b).value=a.values[b])},c=0,d=Object.keys(a.values);c<d.length;c++)b()}})["catch"](function(a){return console.error("Error: "+a)})}),document.getElementById("pickup-address-dropdown").addEventListener("change",function(a){var b=a.target.dataset.url+"&address="+a.target.value;fetch(b).then(function(a){return a.json()}).then(function(a){if(!0===a.success)for(var b,c=0,d=Object.keys(a.values);c<d.length;c++)b=d[c],document.getElementById("pickupaddress-"+b)&&(document.getElementById("pickupaddress-"+b).value="",document.getElementById("pickupaddress-"+b).value=a.values[b])})["catch"](function(a){return console.error("Error: "+a)})}),document.getElementById("account-dropdown").addEventListener("change",function(a){document.querySelector("#create-parcel-shipment #send-to-parcel").innerText="$btnMsg "+a.target.options[a.target.selectedIndex].text}),document.getElementById("PackageCount").addEventListener("change",function(b){for(var c=parseInt(b.target.value),d=document.getElementById("packageWrapper");d.firstChild;)d.removeChild(d.firstChild);a(c)}),document.querySelectorAll(".packageNumBtn").forEach(function(b){b.addEventListener("click",function(b){b.preventDefault();var c=parseInt(b.target.getAttribute("data-val"));document.getElementById("PackageCount").value=c;for(var d=document.getElementById("packageWrapper");d.firstChild;)d.removeChild(d.firstChild);a(c)})}),document.querySelector("body").addEventListener("click",function(a){a.target.classList.contains("remove-package")&&(a.preventDefault(),document.getElementById("PackageCount").value-=1,a.target.closest(".well").querySelectorAll("input").forEach(function(a){$("#create-parcel-shipment").yiiActiveForm("remove",a.id)}),a.target.closest(".well").remove())})});
